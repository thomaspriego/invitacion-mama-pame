<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Mama Pame ğŸ’˜</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800;900&display=swap" rel="stylesheet">

<style>
  :root{
    --pink:#ff2f63;
    --bg1:#ffd6e0;
    --bg2:#ff9fb2;
    --card: rgba(255,255,255,.78);
    --card2: rgba(255,255,255,.92);
    --text:#1f1f1f;
    --line: rgba(0,0,0,.28);
  }
  *{box-sizing:border-box}

  body{
    margin:0;
    font-family:"Poppins", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    overflow:hidden;
    height:100vh;
    color:var(--text);
    display:flex;
    justify-content:center;
    align-items:center;
    padding:18px;

    background:
      radial-gradient(900px 600px at 20% 15%, rgba(255,255,255,.60), transparent 60%),
      radial-gradient(900px 600px at 80% 90%, rgba(255,255,255,.35), transparent 62%),
      linear-gradient(135deg,var(--bg1),var(--bg2));
  }

  /* blobs suaves */
  body::before, body::after{
    content:"";
    position:fixed;
    width:520px;
    height:520px;
    border-radius:50%;
    filter: blur(52px);
    opacity:.45;
    z-index:-1;
    pointer-events:none;
  }
  body::before{
    left:-160px; top:-140px;
    background: radial-gradient(circle at 30% 30%, rgba(255,47,99,.55), transparent 60%);
  }
  body::after{
    right:-200px; bottom:-200px;
    background: radial-gradient(circle at 30% 30%, rgba(255,159,28,.55), transparent 60%);
  }

  /* flotantes */
  .float{
    position:absolute;
    pointer-events:none;
    animation: floatUp linear forwards;
    filter: drop-shadow(0 12px 14px rgba(0,0,0,.10));
    opacity:.95;
  }
  @keyframes floatUp{
    from{ transform: translateY(12vh) rotate(-10deg); opacity:0; }
    10%{ opacity:.95; }
    to{ transform: translateY(-135vh) rotate(12deg); opacity:0; }
  }

  /* botones */
  button{
    padding:12px 18px;
    border:none;
    border-radius:999px;
    font-weight:900;
    cursor:pointer;
    transition: transform .12s ease, opacity .12s ease, box-shadow .12s ease;
    user-select:none;
  }
  button:active{ transform: translateY(1px) scale(.99); }

  .yes{
    background: var(--pink);
    color:white;
    box-shadow: 0 16px 34px rgba(255,47,99,.30);
  }
  .yes:hover{ transform: translateY(-1px); }
  .no{
    background: rgba(255,255,255,.86);
    border:1px solid rgba(0,0,0,.10);
  }

  /* ===== BotÃ³n sonido ===== */
  #soundToggle{
    position:fixed;
    top:20px;
    right:20px;
    z-index:200;
    background:rgba(255,255,255,.86);
    border:1px solid rgba(0,0,0,.10);
    border-radius:50%;
    width:46px;
    height:46px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:18px;
    box-shadow:0 12px 28px rgba(0,0,0,.18);
    padding:0;
  }

  /* ===== INTRO ===== */
  #intro{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.40);
    backdrop-filter: blur(8px);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:50;
    padding:18px;
  }
  .introCard{
    width:min(560px, 100%);
    background: var(--card);
    border:1px solid rgba(255,255,255,.6);
    border-radius:26px;
    padding:22px 20px;
    text-align:center;
    box-shadow: 0 26px 90px rgba(0,0,0,.24);
    backdrop-filter: blur(14px);
    position:relative;
    overflow:hidden;
  }
  .introCard::before{
    content:"";
    position:absolute; inset:-1px;
    background: radial-gradient(700px 260px at 20% 0%, rgba(255,47,99,.25), transparent 60%),
                radial-gradient(700px 260px at 80% 100%, rgba(255,159,28,.18), transparent 55%);
    pointer-events:none;
  }
  .introCard > *{ position:relative; }
  .introCard h2{ margin:0 0 8px; font-size:22px; font-weight:900; letter-spacing:-.2px; }
  .introCard p{ margin:0; opacity:.86; line-height:1.35; font-weight:600; }
  .introHint{ margin-top:10px; font-size:13px; opacity:.78; font-weight:600; }
  #startBtn{
    margin-top:14px;
    background:#111;
    color:white;
    opacity:.96;
    box-shadow: 0 16px 35px rgba(0,0,0,.22);
  }
  #startBtn:hover{ opacity:1; transform: translateY(-1px); }

  /* ===== ESCENA (ruta) ===== */
  #scene{
    width:min(860px, 92vw);
    height:min(380px, 50vh);
    position:relative;
    display:none;
    border-radius:26px;
    background: rgba(255,255,255,.28);
    border:1px solid rgba(255,255,255,.55);
    box-shadow:0 22px 80px rgba(0,0,0,.16);
    overflow:hidden;
    backdrop-filter: blur(14px);
  }
  .sceneTitle{
    position:absolute;
    top:12px; left:14px;
    padding:8px 12px;
    border-radius:999px;
    background:rgba(255,255,255,.78);
    border:1px solid rgba(0,0,0,.06);
    font-weight:900;
    font-size:13px;
    box-shadow: 0 10px 26px rgba(0,0,0,.10);
    z-index:3;
  }
  .point{
    position:absolute;
    display:flex;
    align-items:center;
    gap:8px;
    font-weight:900;
    font-size:14px;
    padding:10px 12px;
    border-radius:999px;
    background:rgba(255,255,255,.85);
    border:1px solid rgba(0,0,0,.06);
    box-shadow:0 10px 24px rgba(0,0,0,.10);
    transform: translate(-50%, -50%);
    white-space:nowrap;
    z-index:3;
  }
  #chile{ left:16%; top:72%; }
  #ecuador{ left:84%; top:38%; }

  #routeSvg{
    position:absolute;
    inset:0;
    width:100%;
    height:100%;
    pointer-events:none;
    z-index:1;
  }
  #routePath{
    fill:none;
    stroke: var(--line);
    stroke-width: 3;
    stroke-linecap: round;
    stroke-dasharray: 7 10;
    filter: drop-shadow(0 10px 14px rgba(0,0,0,.08));
  }
  #glowPath{
    fill:none;
    stroke: url(#glowGrad);
    stroke-width: 6;
    stroke-linecap: round;
    stroke-dasharray: 60 260;
    opacity:0;
    filter: drop-shadow(0 12px 18px rgba(255,47,99,.18));
  }
  .glowOn{
    opacity:.95;
    animation: dashMove 1.25s linear infinite;
  }
  @keyframes dashMove{
    to{ stroke-dashoffset: -320; }
  }

  /* aviÃ³n png */
  #plane{
    position:absolute;
    left:16%;
    top:72%;
    transform: translate(-50%,-50%) rotate(0deg);
    filter: drop-shadow(0 16px 18px rgba(0,0,0,.18));
    will-change: transform, left, top;
    z-index:2;
  }
  #plane img{
    width:78px;
    height:auto;
    display:block;
  }

  /* ===== Foto momento (OpciÃ³n A) ===== */
  #photoMoment{
    position:fixed;
    inset:0;
    display:none;
    align-items:center;
    justify-content:center;
    background:rgba(0,0,0,.55);
    backdrop-filter: blur(8px);
    z-index:60;
    padding:18px;
  }
  .photoCard{
    width:min(720px, 92vw);
    background: rgba(255,255,255,.22);
    border:1px solid rgba(255,255,255,.45);
    border-radius:26px;
    padding:16px;
    backdrop-filter: blur(14px);
    box-shadow:0 26px 90px rgba(0,0,0,.30);
    text-align:center;
    animation: popIn .55s ease both;
  }
  @keyframes popIn{
    from{ opacity:0; transform: translateY(12px) scale(.98); }
    to{ opacity:1; transform: translateY(0) scale(1); }
  }
  .photoCard img{
    width:100%;
    max-height:62vh;
    object-fit:cover;
    border-radius:20px;
    box-shadow:0 18px 60px rgba(0,0,0,.35);
    border:1px solid rgba(255,255,255,.45);
  }
  #typeText{
    margin:14px 6px 4px;
    color:white;
    font-weight:800;
    font-size: clamp(18px, 3.0vw, 22px);
    text-shadow: 0 12px 30px rgba(0,0,0,.35);
    min-height: 2.4em; /* para que no salte al escribir */
  }

  /* ===== INVITACIÃ“N ===== */
  #cardFinal{
    display:none;
    width:min(560px, 92vw);
    background: var(--card);
    padding:26px 22px;
    border-radius:26px;
    text-align:center;
    box-shadow: 0 26px 90px rgba(0,0,0,.18);
    border:1px solid rgba(255,255,255,.65);
    backdrop-filter: blur(14px);
    position:relative;
    overflow:hidden;
  }
  #cardFinal::before{
    content:"";
    position:absolute; inset:-1px;
    background: radial-gradient(650px 240px at 20% 0%, rgba(255,47,99,.22), transparent 60%),
                radial-gradient(650px 240px at 80% 100%, rgba(255,159,28,.16), transparent 55%);
    pointer-events:none;
  }
  #cardFinal > *{ position:relative; }

  #cardFinal h2{
    margin:0 0 8px;
    font-size:26px;
    font-weight:900;
    letter-spacing:-.3px;
  }
  #cardFinal p{
    margin:6px 0;
    opacity:.90;
    line-height:1.35;
    font-weight:600;
  }
  .badge{
    display:inline-flex;
    align-items:center;
    gap:8px;
    margin-top:10px;
    padding:10px 12px;
    border-radius:999px;
    background: rgba(255,255,255,.78);
    border:1px solid rgba(0,0,0,.06);
    font-weight:900;
    box-shadow:0 12px 28px rgba(0,0,0,.10);
  }

  /* ===== FINAL ===== */
  #overlay{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.5);
    display:none;
    justify-content:center;
    align-items:center;
    z-index:80;
    padding:18px;
    backdrop-filter: blur(6px);
  }
  .modal{
    width:min(600px, 92vw);
    background: var(--card2);
    padding:22px 18px;
    border-radius:26px;
    text-align:center;
    box-shadow:0 28px 100px rgba(0,0,0,.28);
    border:1px solid rgba(0,0,0,.06);
  }
  .modal h2{ margin:0 0 8px; font-size:24px; font-weight:900; }
  .modal p{ margin:0; font-weight:600; opacity:.9; }
  .pd{
    margin-top:12px;
    padding:12px 14px;
    border-radius:18px;
    background:#fff6e8;
    border:1px solid rgba(255,159,28,.30);
    font-weight:900;
    line-height:1.35;
  }
</style>
</head>

<body>

<!-- BotÃ³n sonido -->
<button id="soundToggle" title="Sonido">ğŸ”Š</button>

<!-- INTRO -->
<div id="intro">
  <div class="introCard">
    <h2>ğŸŠ AtenciÃ³n Mama Pame ğŸŠ</h2>
    <p>Una invitaciÃ³n estÃ¡ por despegar desde <b>Chile</b> hasta <b>Ecuador</b>â€¦</p>
    <div class="introHint">Toca â€œIniciarâ€ para que suene la mÃºsica (reglas del celular ğŸ˜…)</div>
    <button id="startBtn">Iniciar ğŸ’˜</button>
  </div>
</div>

<!-- ESCENA -->
<div id="scene" aria-label="Vuelo Chile Ecuador">
  <div class="sceneTitle">Ruta ultra secreta ğŸ¤«</div>

  <svg id="routeSvg" viewBox="0 0 1000 500" preserveAspectRatio="none">
    <defs>
      <linearGradient id="glowGrad" x1="0" y1="0" x2="1" y2="0">
        <stop offset="0%"  stop-color="rgba(255,47,99,0)"/>
        <stop offset="35%" stop-color="rgba(255,47,99,.85)"/>
        <stop offset="65%" stop-color="rgba(255,159,28,.75)"/>
        <stop offset="100%" stop-color="rgba(255,159,28,0)"/>
      </linearGradient>
    </defs>

    <path id="routePath" d="" />
    <path id="glowPath" d="" />
  </svg>

  <div id="chile" class="point">ğŸ‡¨ğŸ‡± Chile</div>
  <div id="ecuador" class="point">ğŸ‡ªğŸ‡¨ Ecuador</div>

  <div id="plane" title="Mandarina-AviÃ³n">
    <img src="plane.png" alt="Mandarina aviÃ³n (PNG)">
  </div>
</div>

<!-- FOTO (OpciÃ³n A) -->
<div id="photoMoment">
  <div class="photoCard">
    <img src="foto1.jpg" alt="Nosotros">
    <div id="typeText"></div>
  </div>
</div>

<!-- INVITACIÃ“N -->
<div id="cardFinal">
  <h2>Mama Pame ğŸ’–</h2>
  <p><b>Â¿Quieres ser mi San ValentÃ­n?</b></p>

  <div class="badge">ğŸ¤« Plan: sorpresa &nbsp;|&nbsp; âœ¨ TÃº: protagonista</div>

  <div style="height:14px"></div>
  <button class="yes" id="yesBtn">SÃ­ obvio ğŸ’˜</button>
  <button class="no" id="noBtn">No ğŸ™ˆ</button>

  <p style="margin-top:12px;font-size:13px;opacity:.72;font-weight:600">
    *El botÃ³n â€œNoâ€ tiene cosquillas.*
  </p>
</div>

<!-- FINAL -->
<div id="overlay">
  <div class="modal">
    <div style="font-size:44px">ğŸ¥°ğŸŠ</div>
    <h2>SabÃ­a que dirÃ­as que sÃ­ ğŸ˜ŒğŸ’–</h2>
    <p>Entonces prepÃ¡rate para el plan sorpresa âœ¨</p>
    <div class="pd">PD: Se que tienes que ser mama pamelita preciosa ese dia, asi que la chiqui esta invitada</div>
    <button style="background:#111;color:#fff; box-shadow:0 16px 38px rgba(0,0,0,.22); margin-top:14px;" id="closeBtn">Cerrar ğŸ’</button>
  </div>
</div>

<audio id="music" src="cancion.mp3" loop></audio>

<script>
  const startBtn = document.getElementById("startBtn");
  const intro = document.getElementById("intro");
  const scene = document.getElementById("scene");
  const plane = document.getElementById("plane");
  const cardFinal = document.getElementById("cardFinal");
  const photoMoment = document.getElementById("photoMoment");
  const typeTextEl = document.getElementById("typeText");

  const yesBtn = document.getElementById("yesBtn");
  const noBtn = document.getElementById("noBtn");
  const overlay = document.getElementById("overlay");
  const closeBtn = document.getElementById("closeBtn");

  const music = document.getElementById("music");
  const soundToggle = document.getElementById("soundToggle");

  const routePath = document.getElementById("routePath");
  const glowPath  = document.getElementById("glowPath");

  // ===== A) toggle sonido =====
  soundToggle.onclick = () => {
    music.muted = !music.muted;
    soundToggle.textContent = music.muted ? "ğŸ”‡" : "ğŸ”Š";
  };

  // ===== Flotantes (corazones + mandarinas) =====
  const hearts = ["ğŸ’–","ğŸ’˜","â¤ï¸","ğŸ’•"];
  function spawnFloat(){
    const el = document.createElement("div");
    el.className = "float";
    el.textContent = (Math.random() < 0.58) ? hearts[(Math.random()*hearts.length)|0] : "ğŸŠ";
    el.style.left = (Math.random()*100) + "vw";
    el.style.bottom = (-10 - Math.random()*20) + "vh";
    el.style.fontSize = (16 + Math.random()*18) + "px";
    el.style.animationDuration = (4 + Math.random()*4) + "s";
    document.body.appendChild(el);
    setTimeout(() => el.remove(), 9000);
  }
  setInterval(spawnFloat, 220);

  // ===== B) mÃ¡quina de escribir =====
  function typeWriter(text, element, speed = 40){
    element.textContent = "";
    let i = 0;
    function typing(){
      if(i < text.length){
        element.textContent += text.charAt(i);
        i++;
        setTimeout(typing, speed);
      }
    }
    typing();
  }

  // ===== Util: centro de un elemento dentro de scene => coords SVG (1000x500) =====
  function centerInScene(el){
    const sceneRect = scene.getBoundingClientRect();
    const r = el.getBoundingClientRect();
    const cx = (r.left + r.width/2) - sceneRect.left;
    const cy = (r.top + r.height/2) - sceneRect.top;
    return {
      x: (cx / sceneRect.width) * 1000,
      y: (cy / sceneRect.height) * 500
    };
  }

  // ===== Construye curva + prepara lÃ­nea punteada + glow =====
  function buildRoute(){
    const a = centerInScene(document.getElementById("chile"));
    const b = centerInScene(document.getElementById("ecuador"));

    const midX = (a.x + b.x) / 2;
    const lift = 175;

    const c1 = { x: a.x + (midX - a.x)*0.35, y: a.y - lift };
    const c2 = { x: b.x - (b.x - midX)*0.35, y: b.y - lift };

    const d = `M ${a.x} ${a.y} C ${c1.x} ${c1.y}, ${c2.x} ${c2.y}, ${b.x} ${b.y}`;
    routePath.setAttribute("d", d);
    glowPath.setAttribute("d", d);

    const len = routePath.getTotalLength();
    routePath.style.strokeDasharray = "7 10";
    routePath.style.strokeDashoffset = len; // escondida al inicio
    routePath.dataset.len = String(len);

    glowPath.style.strokeDashoffset = 0;
  }

  // ===== Vuelo por la curva + dibuja lÃ­nea =====
  function flyAlongPath(durationMs){
    const len = Number(routePath.dataset.len || 0);
    const start = performance.now();

    glowPath.classList.add("glowOn");

    // dibuja punteado
    function drawLine(now){
      const t = Math.min(1, (now - start) / durationMs);
      routePath.style.strokeDashoffset = (1 - t) * len;
      if(t < 1) requestAnimationFrame(drawLine);
    }
    requestAnimationFrame(drawLine);

    // mueve aviÃ³n
    function move(now){
      const t = Math.min(1, (now - start) / durationMs);
      const p = routePath.getPointAtLength(t * len);

      const sceneRect = scene.getBoundingClientRect();
      const leftPx = (p.x/1000) * sceneRect.width;
      const topPx  = (p.y/500)  * sceneRect.height;

      plane.style.left = leftPx + "px";
      plane.style.top  = topPx + "px";

      const p2 = routePath.getPointAtLength(Math.min(len, t*len + 10));
      const ang = Math.atan2(p2.y - p.y, p2.x - p.x) * 180 / Math.PI;
      plane.style.transform = `translate(-50%, -50%) rotate(${ang}deg)`;

      if(t < 1) requestAnimationFrame(move);
    }
    requestAnimationFrame(move);

    return new Promise(res => setTimeout(() => {
      glowPath.classList.remove("glowOn");
      res();
    }, durationMs + 60));
  }

  // ===== Iniciar secuencia =====
  startBtn.onclick = async () => {
    // mÃºsica (necesita interacciÃ³n)
    try { await music.play(); } catch(e){}

    intro.style.display = "none";
    scene.style.display = "block";

    buildRoute();
    await flyAlongPath(3200);

    // mostrar foto + texto tipeado
    scene.style.display = "none";
    photoMoment.style.display = "flex";
    typeWriter("Por un dia exclusivamente por y para amar ğŸ’–.", typeTextEl, 40);

    // duraciÃ³n de la foto (5s mÃ¡s)
    const PHOTO_MS = 8000;

    setTimeout(() => {
      photoMoment.style.display = "none";
      cardFinal.style.display = "block";
    }, PHOTO_MS);
  };

  // ===== SÃ­ / No =====
  yesBtn.onclick = () => {
    overlay.style.display = "flex";
    for(let i=0;i<26;i++) setTimeout(spawnFloat, i*25);
  };

  let noTries = 0;
  function moveNo(){
    const cardRect = cardFinal.getBoundingClientRect();
    const btnRect = noBtn.getBoundingClientRect();
    const pad = 14;

    const maxX = cardRect.width - btnRect.width - pad*2;
    const maxY = cardRect.height - btnRect.height - pad*2;

    const x = pad + Math.random() * Math.max(20, maxX);
    const y = pad + Math.random() * Math.max(20, maxY);

    noBtn.style.position = "absolute";
    noBtn.style.left = x + "px";
    noBtn.style.top  = y + "px";

    noTries++;
    if(noTries === 6) noBtn.textContent = "Â¿Segura? ğŸ˜…";
    if(noTries === 10) noBtn.textContent = "Ya puesâ€¦ ğŸ™ƒ";
    if(noTries >= 14) noBtn.textContent = "Ok ok ğŸ˜³";
  }
  noBtn.addEventListener("mouseenter", ()=> { if(noTries < 14) moveNo(); });
  noBtn.addEventListener("touchstart", (e)=> { if(noTries < 14){ e.preventDefault(); moveNo(); } }, {passive:false});
  noBtn.addEventListener("click", ()=> { noBtn.textContent = "ğŸ˜³"; });

  closeBtn.onclick = () => overlay.style.display = "none";

  // si cambias tamaÃ±o mientras escena visible, recalcula ruta
  window.addEventListener("resize", () => {
    if(scene.style.display === "block"){
      buildRoute();
    }
  });
</script>

</body>
</html>

